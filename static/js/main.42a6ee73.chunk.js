(this["webpackJsonpgist-tickets"]=this["webpackJsonpgist-tickets"]||[]).push([[0],{61:function(e,t,n){},71:function(e,t,n){},83:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(20),i=n.n(c),s=(n(71),n(8)),l=(n(60),n(51)),u=n(91),o=n(87),d=n(92),j=(n(61),n(2)),b=n(66),O=n(7),x=n(9),h=n.n(x),v=n(12),p=n(86),f=n(85),m=n(88),g=n(89),k=n(90),y=n(1),w=function(e){var t=e.onAdd,n=Object(a.useState)(""),r=Object(s.a)(n,2),c=r[0],i=r[1],l=Object(a.useState)(null),u=Object(s.a)(l,2),o=u[0],d=u[1],j=Object(a.useState)(""),b=Object(s.a)(j,2),O=b[0],x=b[1],h=Object(a.useState)(!1),v=Object(s.a)(h,2),p=v[0],m=v[1],w=Object(a.useState)("title"),N=Object(s.a)(w,2),S=N[0],T=N[1];return Object(y.jsxs)(g.a,{noValidate:!0,validated:p,onSubmit:function(e){e.preventDefault(),0===c.length?(T("title"),m(!0)):null===o||o<1?(T("number"),m(!0)):0===O.length?(T("content"),m(!0)):t({title:c,number:o,content:O})},children:[Object(y.jsxs)(k.a,{className:"mb-3",activeKey:S,onSelect:function(e){return T(null!==e&&void 0!==e?e:void 0)},children:[Object(y.jsxs)(k.a.Item,{eventKey:"title",children:[Object(y.jsx)(k.a.Header,{id:"AddTicket-title-label",children:"Tytu\u0142"}),Object(y.jsx)(k.a.Body,{children:Object(y.jsx)(g.a.Control,{type:"text",value:c,onChange:function(e){return i(e.target.value)},required:!0,"aria-labelledby":"AddTicket-title-label"})})]}),Object(y.jsxs)(k.a.Item,{eventKey:"number",children:[Object(y.jsx)(k.a.Header,{id:"AddTicket-number-label",children:"Numer"}),Object(y.jsx)(k.a.Body,{children:Object(y.jsx)(g.a.Control,{type:"number",value:null!==o&&void 0!==o?o:"",min:1,onChange:function(e){var t=parseInt(e.target.value,10);d(isNaN(t)?null:t)},required:!0,"aria-labelledby":"AddTicket-number-label"})})]}),Object(y.jsxs)(k.a.Item,{eventKey:"content",children:[Object(y.jsx)(k.a.Header,{id:"AddTicket-content-label",children:"Tre\u015b\u0107"}),Object(y.jsx)(k.a.Body,{children:Object(y.jsx)(g.a.Control,{as:"textarea",className:"AddTicket-content-textarea",value:O,onChange:function(e){return x(e.target.value)},required:!0,"aria-labelledby":"AddTicket-content-label"})})]})]}),Object(y.jsx)("div",{className:"text-center",children:Object(y.jsx)(f.a,{type:"submit",children:"Utw\xf3rz"})})]})},N=n(93),S=n(65),T=function(e){var t=e.tickets,n=e.onDelete;return Object(y.jsx)(N.a,{children:t.map((function(e){return Object(y.jsxs)(N.a.Item,{className:"List-item",children:[Object(y.jsxs)("div",{className:"List-item-header",children:[Object(y.jsxs)("h3",{children:[e.title," ",Object(y.jsxs)("span",{className:"List-item-number",children:["#",e.number]})]}),Object(y.jsx)(f.a,{onClick:function(){return n(e.id)},variant:"outline-dark","aria-label":"Usu\u0144",className:"List-item-delete",children:Object(y.jsx)(S.a,{})})]}),e.content.split("\n").map((function(e,t){return Object(y.jsxs)(r.a.Fragment,{children:[e,Object(y.jsx)("br",{})]},t)}))]},e.id)}))})},C="ticket.json",L=function(e){var t=e.user,n=Object(a.useState)("list"),r=Object(s.a)(n,2),c=r[0],i=r[1],l=Object(a.useState)([]),u=Object(s.a)(l,2),o=u[0],d=u[1],x=Object(a.useState)(null),g=Object(s.a)(x,2),k=g[0],N=g[1],S=t.octokit;return Object(a.useEffect)((function(){(function(){var e=Object(v.a)(h.a.mark((function e(){var t,n,a,r,c;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.request("GET /gists");case 3:return t=e.sent,n=t.data.filter((function(e){var t=Object.keys(e.files);return 1===t.length&&t[0]===C})),a=new Map(n.map((function(e){return[e.node_id,e.id]}))),e.next=8,S.graphql("\n                    query gists($node_ids: [ID!]!){\n                        nodes(ids: $node_ids) {\n                            ... on Gist {\n                                id\n                                description\n                                files (limit: 1) {\n                                    name\n                                    text\n                                }\n                            }\n                        }\n                    }\n                ",{node_ids:n.map((function(e){return e.node_id}))});case 8:r=e.sent,c=r.nodes,d(c.flatMap((function(e){var t,n,r,c,i=null===e||void 0===e||null===(t=e.files)||void 0===t?void 0:t[0];if("string"!==typeof(null===e||void 0===e?void 0:e.description))return[];if((null===i||void 0===i?void 0:i.name)!==C||"string"!==typeof(null===i||void 0===i?void 0:i.text))return[];try{c=JSON.parse(i.text)}catch(s){return[]}return"number"!==typeof(null===(n=c)||void 0===n?void 0:n.number)||"string"!==typeof(null===(r=c)||void 0===r?void 0:r.content)?[]:[{title:e.description,number:c.number,content:c.content,id:a.get(e.id)}]}))),e.next=16;break;case 13:e.prev=13,e.t0=e.catch(0),N("error");case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}})()()}),[S]),Object(y.jsxs)("div",{children:["added"===k&&Object(y.jsx)(p.a,{variant:"success",children:"Dodano ticket."}),"deleted"===k&&Object(y.jsx)(p.a,{variant:"info",children:"Usuni\u0119to ticket."}),"error"===k&&Object(y.jsx)(p.a,{variant:"danger",children:"Wyst\u0105pi\u0142 b\u0142\u0105d."}),Object(y.jsx)("div",{className:"mb-3",children:Object(y.jsx)(f.a,{onClick:function(){return i("add")},children:"Utw\xf3rz"})}),Object(y.jsx)(T,{tickets:o,onDelete:function(){var e=Object(v.a)(h.a.mark((function e(t){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.request("DELETE /gists/{gist_id}",{gist_id:t});case 3:d(o.filter((function(e){return e.id!==t}))),N("deleted"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),N("error");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()}),Object(y.jsxs)(m.a,{show:"add"===c,onHide:function(){return i("list")},size:"lg",children:[Object(y.jsx)(m.a.Header,{closeButton:!0,children:Object(y.jsx)(m.a.Title,{children:"Utw\xf3rz ticket"})}),Object(y.jsx)(m.a.Body,{children:Object(y.jsx)(w,{onAdd:function(){var e=Object(v.a)(h.a.mark((function e(t){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,S.request("POST /gists",{description:t.title,files:Object(O.a)({},C,{content:JSON.stringify({number:t.number,content:t.content})}),public:!1});case 3:n=e.sent,d([Object(j.a)(Object(j.a)({},t),{},{id:n.data.id})].concat(Object(b.a)(o))),i("list"),N("added"),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),N("error");case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()})})]})]})},I=function(e){var t=e.onLogin,n=Object(a.useState)(""),r=Object(s.a)(n,2),c=r[0],i=r[1],u=Object(a.useState)(""),o=Object(s.a)(u,2),d=o[0],j=o[1],b=Object(a.useState)(!1),O=Object(s.a)(b,2),x=O[0],m=O[1],k=Object(a.useState)(null),w=Object(s.a)(k,2),N=w[0],S=w[1];return Object(y.jsx)("div",{className:"Login",children:Object(y.jsxs)(g.a,{noValidate:!0,validated:x,onSubmit:function(){var e=Object(v.a)(h.a.mark((function e(n){var a,r,i;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),n.currentTarget.checkValidity()){e.next=4;break}return m(!0),e.abrupt("return");case 4:return e.prev=4,r=new l.a({auth:d}),e.next=8,r.request("GET /user");case 8:i=e.sent,m(!1),c!==i.data.login?S("Nieprawid\u0142owe dane logowania."):(null===(a=i.headers["x-oauth-scopes"])||void 0===a?void 0:a.split(", ").includes("gist"))?t(i.data.login,d):S('Token nie ma uprawnienia "gist".'),e.next=17;break;case 13:e.prev=13,e.t0=e.catch(4),m(!1),401===e.t0.status?S("Nieprawid\u0142owe dane logowania."):500===e.t0.status?S("Nieudane po\u0142\u0105czenie z serwerem."):S("Wyst\u0105pi\u0142 b\u0142\u0105d. (".concat(e.t0.status," ").concat(e.t0.message,")"));case 17:case"end":return e.stop()}}),e,null,[[4,13]])})));return function(t){return e.apply(this,arguments)}}(),children:[Object(y.jsxs)(g.a.Group,{className:"mb-3",controlId:"Login-username",children:[Object(y.jsx)(g.a.Label,{children:"Nazwa u\u017cytkownika"}),Object(y.jsx)(g.a.Control,{type:"text",value:c,onChange:function(e){return i(e.target.value)},required:!0})]}),Object(y.jsxs)(g.a.Group,{className:"mb-3",controlId:"Login-token",children:[Object(y.jsx)(g.a.Label,{children:"Klucz API"}),Object(y.jsx)(g.a.Control,{type:"password",value:d,onChange:function(e){return j(e.target.value)},required:!0})]}),null!==N&&Object(y.jsx)(p.a,{variant:"danger",children:N}),Object(y.jsx)("div",{className:"text-center",children:Object(y.jsx)(f.a,{variant:"primary",type:"submit",children:"Zaloguj"})})]})})},A=function(){var e=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:localStorage,r=Object(a.useState)((function(){var a=n.getItem(e);return null!==a?JSON.parse(a):t})),c=Object(s.a)(r,1)[0];return Object(a.useEffect)((function(){null!==c?n.setItem(e,JSON.stringify(c)):n.removeItem(e)}),[e,c,n]),r}("credentials",null),t=Object(s.a)(e,2),n=t[0],r=t[1];return Object(y.jsx)("div",{className:"App-wrapper",children:Object(y.jsxs)("div",{className:"App",children:[Object(y.jsx)(u.a,{variant:"light",bg:"light",expand:"sm",className:"mb-3",children:Object(y.jsxs)(o.a,{children:[Object(y.jsx)(u.a.Brand,{children:"Tickety"}),null!==n&&Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(u.a.Toggle,{}),Object(y.jsxs)(u.a.Collapse,{className:"justify-content-end",children:[Object(y.jsxs)(u.a.Text,{children:["U\u017cytkownik: ",n.name]}),Object(y.jsx)(d.a,{children:Object(y.jsx)(d.a.Link,{onClick:function(){return r(null)},children:"Wyloguj"})})]})]})]})}),null!==n?Object(y.jsx)(L,{user:{name:n.name,octokit:new l.a({auth:n.token})}}):Object(y.jsx)(I,{onLogin:function(e,t){r({name:e,token:t})}})]})})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,94)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),c(e),i(e)}))};i.a.render(Object(y.jsx)(r.a.StrictMode,{children:Object(y.jsx)(A,{})}),document.getElementById("root")),q()}},[[83,1,2]]]);
//# sourceMappingURL=main.42a6ee73.chunk.js.map